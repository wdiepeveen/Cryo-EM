2021-04-16 16:00:02,919 INFO This script illustrates orientation estimation using synchronization matrix and voting method
2021-04-16 16:00:02,919 INFO Initialize simulation object and CTF filters.
2021-04-16 16:00:02,919 INFO Load 3D map and downsample 3D map to desired grids of 5 x 5 x 5.
2021-04-16 16:00:03,406 INFO Use downsampled map to creat simulation object.
2021-04-16 16:00:03,422 DEBUG Corresponding type is already real float32.
2021-04-16 16:00:03,422 DEBUG nufft passed real_type for signal, converting
2021-04-16 16:00:03,422 INFO Trying NFFT backend finufft
2021-04-16 16:00:03,427 INFO NFFT backend finufft usable.
2021-04-16 16:00:03,427 INFO Trying NFFT backend cufinufft
2021-04-16 16:00:03,427 INFO NFFT backend cufinufft not usable:
	No module named 'pycuda'
2021-04-16 16:00:03,428 INFO Trying NFFT backend pynfft
2021-04-16 16:00:03,428 INFO NFFT backend pynfft not usable:
	No module named 'pynfft'
2021-04-16 16:00:03,428 INFO Selected NFFT backend = finufft.
2021-04-16 16:00:03,428 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,481 INFO Applying forward transformations in pipeline
2021-04-16 16:00:03,481 INFO All forward transformations applied
2021-04-16 16:00:03,481 INFO Loaded 12 images
2021-04-16 16:00:03,537 DEBUG Corresponding type is already real float32.
2021-04-16 16:00:03,537 DEBUG nufft passed real_type for signal, converting
2021-04-16 16:00:03,537 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,550 DEBUG Corresponding type is already real float32.
2021-04-16 16:00:03,550 DEBUG nufft passed real_type for signal, converting
2021-04-16 16:00:03,550 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,561 INFO Expanding 3D map in a spatial-domain Fourierâ€“Bessel basis using the direct method.
2021-04-16 16:00:03,566 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,567 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,571 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,572 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,576 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,576 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,581 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,582 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,587 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,587 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,592 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,592 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,596 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,596 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,600 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,601 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,604 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,605 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,609 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,609 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,615 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,615 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,620 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,620 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,626 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,626 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,631 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,631 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,635 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,635 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,639 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,640 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,644 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,644 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,648 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,648 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,653 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,653 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,658 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,658 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,663 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,663 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,668 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,668 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,673 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,673 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,677 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,677 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,682 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,682 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,689 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,689 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,695 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,695 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,700 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,700 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,706 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,706 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,710 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,710 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,714 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,715 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,719 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,719 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,723 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,723 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,728 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,728 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,732 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,732 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,736 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,737 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,741 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,741 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,745 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,745 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,749 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,749 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,754 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,754 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,760 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,761 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,766 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,766 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,771 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,772 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,777 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,777 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,782 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,782 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,788 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,788 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,794 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,794 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,799 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,799 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,804 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,804 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,809 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,809 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,814 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,814 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,819 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,819 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,824 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,824 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,828 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,828 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,834 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,834 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,839 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,839 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,844 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,844 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,850 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,850 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,855 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,856 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,862 DEBUG Corresponding type is already complex complex64.
2021-04-16 16:00:03,862 DEBUG FinufftPlan adjusted eps=1.1920928955078125e-07 from requested 1e-08.
2021-04-16 16:00:03,864 INFO Determined adjoint mappings. Shape = (5, 5, 5)
2021-04-16 16:00:03,865 INFO Determined adjoint mappings. Shape = (20,)
2021-04-16 16:00:03,865 INFO Computing kernel
2021-04-16 16:00:05,889 CRITICAL 'super' object has no attribute '__getattr__'
Traceback:
  File "/Users/wdiepeveen/Documents/PhD/Projects/2 - Cryo-EM/src/src/Cryo-EM/test/icosahedron.py", line 99, in <module>
    vol = vol_update.update(tol=1e-2)
  File "/Users/wdiepeveen/Documents/PhD/Projects/2 - Cryo-EM/src/src/Cryo-EM/solvers/lifting/update/volume/cg.py", line 122, in update
    est_coeff = self.conj_grad(b_coeff, tol=tol)  # TODO max_it?
  File "/Users/wdiepeveen/Documents/PhD/Projects/2 - Cryo-EM/src/src/Cryo-EM/solvers/lifting/update/volume/cg.py", line 145, in conj_grad
    kernel = self.kernel
  File "/Users/wdiepeveen/Documents/PhD/Projects/2 - Cryo-EM/src/src/Cryo-EM/solvers/lifting/update/volume/cg.py", line 58, in __getattr__
    kernel = self.kernel = self.compute_kernel()
  File "/Users/wdiepeveen/Documents/PhD/Projects/2 - Cryo-EM/src/src/Cryo-EM/solvers/lifting/update/volume/cg.py", line 82, in compute_kernel
    weights = np.repeat(sq_filters_f[:, :, np.newaxis], self.integrator.n, axis=2)
  File "/Users/wdiepeveen/Documents/PhD/Projects/2 - Cryo-EM/src/src/Cryo-EM/solvers/lifting/update/volume/cg.py", line 71, in __getattr__
    return super(LeastSquaresCGUpdate, self).__getattr__(name)

